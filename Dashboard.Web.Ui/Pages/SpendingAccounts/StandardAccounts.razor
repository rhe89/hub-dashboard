@using Dashboard.Services
@using Dashboard.Web.Ui.Helpers
@using Dashboard.ViewModels.Sbanken
@inject ISbankenApiService SbankenApiService;

@if (!ViewModelValidator.IsValid(_accountsViewModel)) 
{
    return;
}

@foreach (var account in _accountsViewModel.Accounts)
    {
        <Grid
            Item
            key="transactions"
            ExtraSmall="@GridSize.Twelve"
            Small="@GridSize.Ten"
            Large="@GridSize.Three"
            Medium="@GridSize.Four">
            <StandardAccount Account="@account"/>
        </Grid>
    }

@code
{
    private AccountsViewModel _accountsViewModel;
    [Parameter]
    public bool Loading { get; set; }
    [Parameter]
    public EventCallback<bool> LoadingChanged { get; set; }
    
    protected override async Task OnInitializedAsync()
    {
        _accountsViewModel = await SbankenApiService.GetStandardAccounts();

        Loading = false;
        
        await LoadingChanged.InvokeAsync(Loading);
    }
}